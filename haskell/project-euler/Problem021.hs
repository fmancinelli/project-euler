module Main where

-- Evaluate the sum of all amicable pairs under 10000.

------------------------------------------------------------------------------

divisors x = filter (\y -> x `rem` y == 0) [1..(x `div` 2)]

------------------------------------------------------------------------------

d = sum . divisors

------------------------------------------------------------------------------

problem21 = sum [x | x <- [1..10000], let d1 = d x, let d2 = d d1, d2 == x, d1 /= x]

------------------------------------------------------------------------------

main = do
  print problem21
